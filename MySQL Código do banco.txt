CREATE DATABASE IF NOT EXISTS projeto_patrica;
USE projeto_patrica;


CREATE TABLE IF NOT EXISTS FORMA_PAGAMENTO
(
    ID_FORMA_PAGAMENTO INT AUTO_INCREMENT PRIMARY KEY,
    DESCRICAO VARCHAR(100) NOT NULL
);



CREATE TABLE IF NOT EXISTS CONDICAO_PAGAMENTO 
(
    ID_CONDICAO_PAGAMENTO INT AUTO_INCREMENT PRIMARY KEY,
    DESCRICAO VARCHAR(100) NOT NULL,
    QUANTIDADE_PARCELAS INT NOT NULL
);



CREATE TABLE IF NOT EXISTS PARCELA_CONDICAO_PAGAMENTO 
(
    ID_CONDICAO_PAGAMENTO INT NOT NULL,
    NUMERO_PARCELA INT NOT NULL,
    ID_FORMA_PAGAMENTO INT NOT NULL,
    VALOR_PERCENTUAL DECIMAL(5,2) NOT NULL,
    DIAS_APOS_VENDA INT NOT NULL,

    PRIMARY KEY (ID_CONDICAO_PAGAMENTO, NUMERO_PARCELA),
    CONSTRAINT FK_Condicao FOREIGN KEY (ID_CONDICAO_PAGAMENTO) REFERENCES CONDICAO_PAGAMENTO(ID_CONDICAO_PAGAMENTO) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FK_Forma FOREIGN KEY (ID_FORMA_PAGAMENTO) REFERENCES FORMA_PAGAMENTO(ID_FORMA_PAGAMENTO) ON DELETE CASCADE ON UPDATE CASCADE
);







































-- Cria o banco de dados se não existir
CREATE DATABASE IF NOT EXISTS projeto_patrica;
USE projeto_patrica;

-- Tabela de formas de pagamento
CREATE TABLE IF NOT EXISTS FORMA_PAGAMENTO
(
    ID_FORMA_PAGAMENTO INT AUTO_INCREMENT PRIMARY KEY,
    DESCRICAO VARCHAR(100) NOT NULL
);

-- Tabela de condições de pagamento
CREATE TABLE IF NOT EXISTS CONDICAO_PAGAMENTO 
(
    ID_CONDICAO_PAGAMENTO INT AUTO_INCREMENT PRIMARY KEY,
    DESCRICAO VARCHAR(100) NOT NULL,
    QUANTIDADE_PARCELAS INT NOT NULL
);

-- Tabela de parcelas da condição de pagamento
CREATE TABLE IF NOT EXISTS PARCELA_CONDICAO_PAGAMENTO 
(
    ID_CONDICAO_PAGAMENTO INT NOT NULL,
    NUMERO_PARCELA INT NOT NULL,
    ID_FORMA_PAGAMENTO INT NOT NULL,
    VALOR_PERCENTUAL DECIMAL(5,2) NOT NULL,
    DIAS_APOS_VENDA INT NOT NULL,
    PRIMARY KEY (ID_CONDICAO_PAGAMENTO, NUMERO_PARCELA),
    CONSTRAINT FK_Condicao FOREIGN KEY (ID_CONDICAO_PAGAMENTO) REFERENCES CONDICAO_PAGAMENTO(ID_CONDICAO_PAGAMENTO)
        ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT FK_Forma FOREIGN KEY (ID_FORMA_PAGAMENTO) REFERENCES FORMA_PAGAMENTO(ID_FORMA_PAGAMENTO)
        ON DELETE CASCADE ON UPDATE CASCADE
);

-- Tabela de países
CREATE TABLE IF NOT EXISTS PAIS
(
    ID_PAIS INT AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(100) NOT NULL
);

-- Tabela de estados
CREATE TABLE IF NOT EXISTS ESTADO
(
    ID_ESTADO INT AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(100) NOT NULL,
    ID_PAIS INT NOT NULL,
    CONSTRAINT FK_Estado_Pais FOREIGN KEY (ID_PAIS) REFERENCES PAIS(ID_PAIS)
        ON DELETE CASCADE ON UPDATE CASCADE
);

-- Tabela de cidades
CREATE TABLE IF NOT EXISTS CIDADE
(
    ID_CIDADE INT AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(100) NOT NULL,
    ID_ESTADO INT NOT NULL,
    CONSTRAINT FK_Cidade_Estado FOREIGN KEY (ID_ESTADO) REFERENCES ESTADO(ID_ESTADO)
        ON DELETE CASCADE ON UPDATE CASCADE
);
